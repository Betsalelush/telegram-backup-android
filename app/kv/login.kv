#:kivy 2.2.1
#:import MDTextField kivymd.uix.textfield.MDTextField
#:import MDFillRoundFlatButton kivymd.uix.button.MDFillRoundFlatButton

<LoginScreen>:
    name: 'login'
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(15)
        
        # Title
        MDLabel:
            text: "Telegram Backup - Login"
            font_style: "H5"
            halign: "center"
            size_hint_y: None
            height: dp(50)
        
        # Status
        MDLabel:
            id: status
            text: "Ready"
            halign: "center"
            theme_text_color: "Primary"
            size_hint_y: None
            height: dp(30)
        
        # Connection Status
        MDLabel:
            id: connection_status
            text: "Status: Disconnected"
            halign: "center"
            theme_text_color: "Secondary"
            size_hint_y: None
            height: dp(30)
        
        # Scroll view for inputs
        MDScrollView:
            MDBoxLayout:
                orientation: 'vertical'
                spacing: dp(10)
                padding: dp(10)
                adaptive_height: True
                
                # API ID
                MDTextField:
                    id: api_id
                    hint_text: "API ID"
                    helper_text: "Get from my.telegram.org"
                    helper_text_mode: "on_focus"
                    size_hint_y: None
                    height: dp(60)
                
                # API Hash
                MDTextField:
                    id: api_hash
                    hint_text: "API Hash"
                    helper_text: "Get from my.telegram.org"
                    helper_text_mode: "on_focus"
                    size_hint_y: None
                    height: dp(60)
                
                # Phone
                MDTextField:
                    id: phone
                    hint_text: "Phone Number"
                    helper_text: "Format: +972501234567"
                    helper_text_mode: "on_focus"
                    size_hint_y: None
                    height: dp(60)
                
                # Send Code Button
                MDFillRoundFlatButton:
                    id: send_btn
                    text: "Send Code"
                    size_hint_x: 1
                    on_release: root.send_code()
                
                # Code
                MDTextField:
                    id: code
                    hint_text: "Verification Code"
                    helper_text: "Enter code from Telegram"
                    helper_text_mode: "on_focus"
                    disabled: True
                    size_hint_y: None
                    height: dp(60)
                
                # 2FA Password
                MDTextField:
                    id: password
                    hint_text: "2FA Password (if enabled)"
                    password: True
                    disabled: True
                    size_hint_y: None
                    height: dp(60)
                
                # Login Button
                MDFillRoundFlatButton:
                    id: login_btn
                    text: "Login"
                    disabled: True
                    size_hint_x: 1
                    on_release: root.login()
                
                # Disconnect Button
                MDFillRoundFlatButton:
                    id: disconnect_btn
                    text: "Disconnect"
                    disabled: True
                    size_hint_x: 1
                    on_release: root.disconnect()
        
        # Log
        MDLabel:
            text: "Log:"
            size_hint_y: None
            height: dp(30)
        
        MDScrollView:
            size_hint_y: 0.3
            
            MDLabel:
                id: log
                text: ""
                size_hint_y: None
                height: self.texture_size[1]
                text_size: self.width, None
