#:kivy 2.2.1
#:import MDTextField kivymd.uix.textfield.MDTextField
#:import MDFillRoundFlatButton kivymd.uix.button.MDFillRoundFlatButton
#:import MDCheckbox kivymd.uix.selectioncontrol.MDCheckbox

<BackupScreen>:
    name: 'backup'
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(15)
        
        # Title
        MDLabel:
            text: "Telegram Backup - Transfer"
            font_style: "H5"
            halign: "center"
            size_hint_y: None
            height: dp(50)
        
        # Status
        MDLabel:
            id: status
            text: "Ready"
            halign: "center"
            theme_text_color: "Primary"
            size_hint_y: None
            height: dp(30)
        
        # Scroll view for inputs
        MDScrollView:
            size_hint_y: 0.4
            
            MDBoxLayout:
                orientation: 'vertical'
                spacing: dp(10)
                padding: dp(10)
                adaptive_height: True
                
                # Source Channel
                MDTextField:
                    id: source
                    hint_text: "Source Channel"
                    helper_text: "Username or ID"
                    helper_text_mode: "on_focus"
                    size_hint_y: None
                    height: dp(60)
                
                # Target Channel
                MDTextField:
                    id: target
                    hint_text: "Target Channel"
                    helper_text: "Username or ID"
                    helper_text_mode: "on_focus"
                    size_hint_y: None
                    height: dp(60)
                
                # Start Message ID
                MDTextField:
                    id: start_message_id
                    hint_text: "Start Message ID (optional)"
                    helper_text: "Leave empty to start from beginning"
                    helper_text_mode: "on_focus"
                    size_hint_y: None
                    height: dp(60)
                
                # File Types
                MDLabel:
                    text: "File Types to Transfer:"
                    size_hint_y: None
                    height: dp(30)
                
                MDBoxLayout:
                    orientation: 'horizontal'
                    spacing: dp(10)
                    size_hint_y: None
                    height: dp(40)
                    
                    MDCheckbox:
                        id: cb_text
                        active: True
                        size_hint_x: None
                        width: dp(40)
                    MDLabel:
                        text: "Text"
                        size_hint_x: 0.25
                    
                    MDCheckbox:
                        id: cb_photos
                        active: True
                        size_hint_x: None
                        width: dp(40)
                    MDLabel:
                        text: "Photos"
                        size_hint_x: 0.25
                
                MDBoxLayout:
                    orientation: 'horizontal'
                    spacing: dp(10)
                    size_hint_y: None
                    height: dp(40)
                    
                    MDCheckbox:
                        id: cb_videos
                        active: True
                        size_hint_x: None
                        width: dp(40)
                    MDLabel:
                        text: "Videos"
                        size_hint_x: 0.25
                    
                    MDCheckbox:
                        id: cb_documents
                        active: True
                        size_hint_x: None
                        width: dp(40)
                    MDLabel:
                        text: "Documents"
                        size_hint_x: 0.25
                
                # Buttons
                MDBoxLayout:
                    orientation: 'horizontal'
                    spacing: dp(10)
                    size_hint_y: None
                    height: dp(50)
                    
                    MDFillRoundFlatButton:
                        id: start_btn
                        text: "Start Backup"
                        disabled: True
                        on_release: root.start_backup()
                    
                    MDFillRoundFlatButton:
                        id: stop_btn
                        text: "Stop"
                        disabled: True
                        on_release: root.stop_backup()
        
        # Progress
        MDLabel:
            text: "Progress:"
            size_hint_y: None
            height: dp(30)
        
        MDProgressBar:
            id: progress_bar
            value: 0
            size_hint_y: None
            height: dp(10)
        
        # Log
        MDLabel:
            text: "Log:"
            size_hint_y: None
            height: dp(30)
        
        MDScrollView:
            MDLabel:
                id: log
                text: ""
                size_hint_y: None
                height: self.texture_size[1]
                text_size: self.width, None
